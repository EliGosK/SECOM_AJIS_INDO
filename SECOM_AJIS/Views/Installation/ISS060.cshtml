@using SECOM_AJIS.DataEntity.Installation
@using SECOM_AJIS.Common.Helpers
@using SECOM_AJIS.Presentation.Installation.Controllers 
@using SECOM_AJIS.Common.Util.ConstantValue
@{
    
 

    ViewBag.lbWidth = "220px";  /* ViewBag.LabelWidth */
    ViewBag.lbWidth2 = "260px";  
    ViewBag.ObjectCol1Width = "130px";
    ViewBag.ObjectCol2Width = "230px";
    ViewBag.ObjectCol3Width = "110px";
    ViewBag.ObjectCol4Width = "180px";
    ViewBag.ObjectColMergeWidth = "720px";
    ViewBag.headText2 = "220px";  
    ViewBag.SubTableWidth = "550px";
    ViewBag.SubLabelCol1Width = "120px";

    ViewBag.C_RENTAL_INSTALL_TYPE_NEW = RentalInstallationType.C_RENTAL_INSTALL_TYPE_NEW;
    ViewBag.C_SALE_INSTALL_TYPE_NEW = SaleInstallationType.C_SALE_INSTALL_TYPE_NEW;
    ViewBag.C_CUSTOMER_REASON_NEW_WORK = CustomerReason.C_CUSTOMER_REASON_NEW_WORK;
    ViewBag.C_SERVICE_TYPE_RENTAL = ServiceType.C_SERVICE_TYPE_RENTAL;
    ViewBag.C_SERVICE_TYPE_SALE = ServiceType.C_SERVICE_TYPE_SALE;
    ViewBag.C_CONTRACT_STATUS_BEF_START = ContractStatus.C_CONTRACT_STATUS_BEF_START;
    ViewBag.C_CUSTOMER_REASON = MiscType.C_CUSTOMER_REASON;
    ViewBag.C_SECOM_REASON = MiscType.C_SECOM_REASON;
    ViewBag.C_LINE_UP_TYPE_STOP_SALE = LineUpType.C_LINE_UP_TYPE_STOP_SALE;
    ViewBag.C_LINE_UP_TYPE_LOGICAL_DELETE = LineUpType.C_LINE_UP_TYPE_LOGICAL_DELETE;
    ViewBag.C_INST_TYPE_GENERAL = InstrumentType.C_INST_TYPE_GENERAL;
    ViewBag.C_EXPANSION_TYPE_PARENT = ExpansionType.C_EXPANSION_TYPE_PARENT;
    ViewBag.C_EXPANSION_TYPE_CHILD = ExpansionType.C_EXPANSION_TYPE_CHILD;  
    
    ViewBag.C_RENTAL_INSTALL_TYPE_CHANGE_WIRING = RentalInstallationType.C_RENTAL_INSTALL_TYPE_CHANGE_WIRING;
    ViewBag.C_RENTAL_INSTALL_TYPE_CHANGEPLAN_AFTER_NEW = RentalInstallationType.C_RENTAL_INSTALL_TYPE_CHANGEPLAN_AFTER_NEW;
    ViewBag.C_RENTAL_INSTALL_TYPE_CHANGEPLAN_NEW = RentalInstallationType.C_RENTAL_INSTALL_TYPE_CHANGEPLAN_NEW;
    ViewBag.C_RENTAL_INSTALL_TYPE_MAINTENANCE_EXCHANGE = RentalInstallationType.C_RENTAL_INSTALL_TYPE_MAINTENANCE_EXCHANGE;
    ViewBag.C_RENTAL_INSTALL_TYPE_MOVE = RentalInstallationType.C_RENTAL_INSTALL_TYPE_MOVE;
    ViewBag.C_RENTAL_INSTALL_TYPE_NEW = RentalInstallationType.C_RENTAL_INSTALL_TYPE_NEW;
    ViewBag.C_RENTAL_INSTALL_TYPE_PERIODICAL_MAINTENANCE = RentalInstallationType.C_RENTAL_INSTALL_TYPE_PERIODICAL_MAINTENANCE;
    ViewBag.C_RENTAL_INSTALL_TYPE_REMOVE_ALL = RentalInstallationType.C_RENTAL_INSTALL_TYPE_REMOVE_ALL;
    ViewBag.C_RENTAL_INSTALL_TYPE_REMOVE_DURING_STOP_PARTIAL = RentalInstallationType.C_RENTAL_INSTALL_TYPE_REMOVE_DURING_STOP_PARTIAL;
    ViewBag.C_RENTAL_INSTALL_TYPE_REMOVE_DURING_STOP_REMOVE_ALL = RentalInstallationType.C_RENTAL_INSTALL_TYPE_REMOVE_DURING_STOP_REMOVE_ALL;
    
    ViewBag.C_SALE_INSTALL_TYPE_ADD = SaleInstallationType.C_SALE_INSTALL_TYPE_ADD;
    ViewBag.C_SALE_INSTALL_TYPE_CHANGE_WIRING = SaleInstallationType.C_SALE_INSTALL_TYPE_CHANGE_WIRING;
    ViewBag.C_SALE_INSTALL_TYPE_MAINTENANCE_EXCHANGE = SaleInstallationType.C_SALE_INSTALL_TYPE_MAINTENANCE_EXCHANGE;
    ViewBag.C_SALE_INSTALL_TYPE_MOVE = SaleInstallationType.C_SALE_INSTALL_TYPE_MOVE; 
    ViewBag.C_SALE_INSTALL_TYPE_NEW = SaleInstallationType.C_SALE_INSTALL_TYPE_NEW;
    ViewBag.C_SALE_INSTALL_TYPE_PARTIAL_REMOVE = SaleInstallationType.C_SALE_INSTALL_TYPE_PARTIAL_REMOVE;
    ViewBag.C_SALE_INSTALL_TYPE_REMOVE_ALL = SaleInstallationType.C_SALE_INSTALL_TYPE_REMOVE_ALL;
    ViewBag.C_LAST_CHANGE_TYPE_CHANGE_PLAN = LastChangeType.C_LAST_CHANGE_TYPE_CHANGE_PLAN;
    ViewBag.C_LINE_UP_TYPE_ONE_TIME = LineUpType.C_LINE_UP_TYPE_ONE_TIME;
    ViewBag.C_LINE_UP_TYPE_TEMPORARY = LineUpType.C_LINE_UP_TYPE_TEMPORARY;
    ViewBag.C_SLIP_STATUS_NOT_STOCK_OUT = SlipStatus.C_SLIP_STATUS_NOT_STOCK_OUT;
    ViewBag.C_SLIP_STATUS_PARTIAL_STOCK_OUT = SlipStatus.C_SLIP_STATUS_PARTIAL_STOCK_OUT;
    ViewBag.C_INSTALL_CHANGE_REASON_CUS = InstallChangeReason.C_INSTALL_CHANGE_REASON_CUS;
    ViewBag.C_INSTALL_CHANGE_REASON_SECOM = InstallChangeReason.C_INSTALL_CHANGE_REASON_SECOM;
    ViewBag.C_INSTALLATION_BY_OTHER = InstallationBy.C_INSTALLATION_BY_OTHER;
    ViewBag.C_CUSTOMER_REASON_OTHER = CustomerReason.C_CUSTOMER_REASON_OTHER;
    //==============================================================
    ViewBag.C_INSTALLATION_BY = MiscType.C_INSTALLATION_BY;
    ViewBag.C_INSTALL_FEE_BILLING_TYPE = MiscType.C_INSTALL_FEE_BILLING_TYPE;
    ViewBag.C_DOC_AUDIT_RESULT_NOT_RECEIVED = DocAuditResult.C_DOC_AUDIT_RESULT_NOT_RECEIVED;
    ViewBag.C_DOC_AUDIT_RESULT_NEED_FOLLOW = DocAuditResult.C_DOC_AUDIT_RESULT_NEED_FOLLOW;
    ViewBag.C_DOC_AUDIT_RESULT_RETURNED = DocAuditResult.C_DOC_AUDIT_RESULT_RETURNED;
    
 }

@section page_header{

<script type="text/javascript" >
    var C_RENTAL_INSTALL_TYPE_NEW = "@ViewBag.C_RENTAL_INSTALL_TYPE_NEW";
    var C_SALE_INSTALL_TYPE_NEW = "@ViewBag.C_SALE_INSTALL_TYPE_NEW";
    var C_CUSTOMER_REASON_NEW_WORK = "@ViewBag.C_CUSTOMER_REASON_NEW_WORK";
    var C_SERVICE_TYPE_RENTAL = "@ViewBag.C_SERVICE_TYPE_RENTAL";
    var C_SERVICE_TYPE_SALE = "@ViewBag.C_SERVICE_TYPE_SALE";
    var C_CONTRACT_STATUS_BEF_START = "@ViewBag.C_CONTRACT_STATUS_BEF_START";
    var C_CUSTOMER_REASON = "@ViewBag.C_CUSTOMER_REASON";
    var C_SECOM_REASON = "@ViewBag.C_SECOM_REASON";
    var C_LINE_UP_TYPE_STOP_SALE = "@ViewBag.C_LINE_UP_TYPE_STOP_SALE";
    var C_LINE_UP_TYPE_LOGICAL_DELETE = "@ViewBag.C_LINE_UP_TYPE_LOGICAL_DELETE";
    var C_INST_TYPE_GENERAL = "@ViewBag.C_INST_TYPE_GENERAL";
    var C_EXPANSION_TYPE_PARENT = "@ViewBag.C_EXPANSION_TYPE_PARENT";
    var C_EXPANSION_TYPE_CHILD = "@ViewBag.C_EXPANSION_TYPE_CHILD";
    var C_RENTAL_INSTALL_TYPE_CHANGE_WIRING = "@ViewBag.C_RENTAL_INSTALL_TYPE_CHANGE_WIRING";
    var C_RENTAL_INSTALL_TYPE_CHANGEPLAN_AFTER_NEW = "@ViewBag.C_RENTAL_INSTALL_TYPE_CHANGEPLAN_AFTER_NEW";
    var C_RENTAL_INSTALL_TYPE_CHANGEPLAN_NEW = "@ViewBag.C_RENTAL_INSTALL_TYPE_CHANGEPLAN_NEW";
    var C_RENTAL_INSTALL_TYPE_MAINTENANCE_EXCHANGE = "@ViewBag.C_RENTAL_INSTALL_TYPE_MAINTENANCE_EXCHANGE";
    var C_RENTAL_INSTALL_TYPE_MOVE = "@ViewBag.C_RENTAL_INSTALL_TYPE_MOVE";
    var C_RENTAL_INSTALL_TYPE_NEW = "@ViewBag.C_RENTAL_INSTALL_TYPE_NEW";
    var C_RENTAL_INSTALL_TYPE_PERIODICAL_MAINTENANCE = "@ViewBag.C_RENTAL_INSTALL_TYPE_PERIODICAL_MAINTENANCE";
    var C_RENTAL_INSTALL_TYPE_REMOVE_ALL = "@ViewBag.C_RENTAL_INSTALL_TYPE_REMOVE_ALL";
    var C_RENTAL_INSTALL_TYPE_REMOVE_DURING_STOP_PARTIAL = "@ViewBag.C_RENTAL_INSTALL_TYPE_REMOVE_DURING_STOP_PARTIAL";
    var C_RENTAL_INSTALL_TYPE_REMOVE_DURING_STOP_REMOVE_ALL = "@ViewBag.C_RENTAL_INSTALL_TYPE_REMOVE_DURING_STOP_REMOVE_ALL";

    var C_SALE_INSTALL_TYPE_ADD = "@ViewBag.C_SALE_INSTALL_TYPE_ADD";
    var C_SALE_INSTALL_TYPE_CHANGE_WIRING = "@ViewBag.C_SALE_INSTALL_TYPE_CHANGE_WIRING";
    var C_SALE_INSTALL_TYPE_MAINTENANCE_EXCHANGE = "@ViewBag.C_SALE_INSTALL_TYPE_MAINTENANCE_EXCHANGE";
    var C_SALE_INSTALL_TYPE_MOVE = "@ViewBag.C_SALE_INSTALL_TYPE_MOVE";
    var C_SALE_INSTALL_TYPE_NEW = "@ViewBag.C_SALE_INSTALL_TYPE_NEW";
    var C_SALE_INSTALL_TYPE_PARTIAL_REMOVE = "@ViewBag.C_SALE_INSTALL_TYPE_PARTIAL_REMOVE";
    var C_SALE_INSTALL_TYPE_REMOVE_ALL = "@ViewBag.C_SALE_INSTALL_TYPE_REMOVE_ALL";
    var C_LAST_CHANGE_TYPE_CHANGE_PLAN = "@ViewBag.C_LAST_CHANGE_TYPE_CHANGE_PLAN";
    var C_LINE_UP_TYPE_ONE_TIME = "@ViewBag.C_LINE_UP_TYPE_ONE_TIME";
    var C_LINE_UP_TYPE_TEMPORARY = "@ViewBag.C_LINE_UP_TYPE_TEMPORARY";
    var C_SLIP_STATUS_NOT_STOCK_OUT = "@ViewBag.C_SLIP_STATUS_NOT_STOCK_OUT";
    var C_SLIP_STATUS_PARTIAL_STOCK_OUT = "@ViewBag.C_SLIP_STATUS_PARTIAL_STOCK_OUT";
    var C_INSTALL_CHANGE_REASON_CUS = "@ViewBag.C_INSTALL_CHANGE_REASON_CUS";
    var C_INSTALL_CHANGE_REASON_SECOM = "@ViewBag.C_INSTALL_CHANGE_REASON_SECOM";
    var C_INSTALLATION_BY_OTHER = "@ViewBag.C_INSTALLATION_BY_OTHER";
    var C_CUSTOMER_REASON_OTHER = "@ViewBag.C_CUSTOMER_REASON_OTHER";
    //====================================================
    var C_INSTALLATION_BY = "@ViewBag.C_INSTALLATION_BY";
    var C_INSTALL_FEE_BILLING_TYPE = "@ViewBag.C_INSTALL_FEE_BILLING_TYPE";

    var C_DOC_AUDIT_RESULT_NOT_RECEIVED = "@ViewBag.C_DOC_AUDIT_RESULT_NOT_RECEIVED";
    var C_DOC_AUDIT_RESULT_NEED_FOLLOW = "@ViewBag.C_DOC_AUDIT_RESULT_NEED_FOLLOW";
    var C_DOC_AUDIT_RESULT_RETURNED = "@ViewBag.C_DOC_AUDIT_RESULT_RETURNED";

    var C_INSTALL_FEE_BILLING_TYPE_PAY_ALL_AMOUNT = "@InstallFeeBillingType.C_INSTALL_FEE_BILLING_TYPE_PAY_ALL_AMOUNT";
    
    var C_INTALL_COMPLETE_MINDATE = "@ViewBag.MinDate";
    var C_INTALL_COMPLETE_MAXDATE = "@ViewBag.MaxDate";

    var _attach_k = '@ViewBag.AttachKey';
</script>
<script src="../../Scripts/Base/DateTimePicker.js" type="text/javascript"></script>
<script type="text/javascript" src="@Url.Content("~/Content/js/dhtmlxgrid/dhtmlxcommon.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Content/js/dhtmlxgrid/dhtmlxgrid.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Content/js/dhtmlxgrid/dhtmlxgridcell.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Content/js/dhtmlxgrid/ext/dhtmlxgrid_data.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Content/js/dhtmlxgrid/ext/dhtmlxgrid_pgn.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Content/js/dhtmlxgrid/excells/dhtmlxgrid_excell_dhxcalendar.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Content/js/dhtmlxgrid/dhtmlxcalendar.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/Base/GridControl.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/Base/ComboBox.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/Installation/ISS060.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/Base/MessageDialog.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/Common/Dialog.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/Master/Dialog.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/Quotation/Dialog.js")"></script>

<link rel="stylesheet" type="text/css" href="@Url.Content("~/Content/js/dhtmlxgrid/dhtmlxgrid.css")"/>
<link rel="stylesheet" type="text/css" href="@Url.Content("~/Content/js/dhtmlxgrid/skins/dhtmlxgrid_dhx_secom.css")"/>
<link rel="stylesheet" type="text/css" href="@Url.Content("~/Content/js/dhtmlxgrid/ext/dhtmlxgrid_pgn_bricks.css")"/>

<link rel="stylesheet" type="text/css" href="@Url.Content("~/Scripts/Upload/jquery.fileupload-ui.css")" />
<script type="text/javascript" src="@Url.Content("~/Scripts/Upload/jquery.fileupload.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/Upload/jquery.fileupload-ui.js")"></script>


}


<!-- Html content --->
<div style="display:none;">

    <div style="display:none;">
        @Resources.ISS010.lblHeaderSpecified
    </div>
    <div  >
        <div style="display:none;">
            @Resources.ISS010.lblContractProjectCode
        </div>
        <div  style="display:none;">
           @Html.CommonTextBox("ContractCodeProjectCode", (string)@ViewBag.ContractProjectCode, new { style = "width:" + @ViewBag.ObjectCol1Width + ";", maxlength = CommonValue.C_MAXLENGTH_CONTRACT_CODE })
        </div>          
        <div style="display:none;">
            @Html.CommonButton("btnRetrieveInstallation", (string)@Resources.ISS010.btnRetrieve, new { style = "width:100px;" })
            @Html.CommonButton("btnClearInstallation", (string)@Resources.ISS010.btnClear, new { style = "width:100px;" })
        </div>
        <div style="display:none;">
            
        </div>     
    </div>
    <div class="usr-row"></div>
    <div class="usr-row"></div>
    <div class="usr-row"></div>
    <div class="usr-row"></div>
 </div>

    @Html.Hidden("ServiceTypeCode")
    @Html.Partial("ISS060/_ISS060_01")
    @Html.Partial("ISS060/_ISS060_02")
    @Html.Partial("ISS060/_ISS060_03")
    @Html.Partial("ISS060/_ISS060_04")
    
    <!---------------------------------- Attached Document list ---------------------------------------------->
    <div id="divAttachedDoclistMain" class="main-table" style="margin-top:5px;">
        <div id="divAttachedDoclist" class="sub-table" style="margin-top:10px; border:none;">
            <div class="table-sub-header">@Resources.CTS300.lblAttachedDocumentList</div>
            <div class="usr-row">
                <div class="usr-label" style="width:@ViewBag.lbWidth;">&nbsp;</div>
                <div class="usr-object" style="width:@ViewBag.ObjectColMergeWidth;">
                    <div id="ISS060_gridAttachDocList" style="width:400px;"></div>
                </div>
            </div>
            <div class="usr-row usr-row-space" id="divAttachFrame">
                <iframe width="100%" height="25px" marginwidth="0" marginheight="0" id="frmAttach"
                        vspace="0" hspace="0" frameborder="0" align="middle" scrolling="no"></iframe>         
            </div>

            <div class="usr-row" id="divAttachRemark">
                <div class="usr-label" style="width:@ViewBag.lbWidth;">&nbsp;</div>
                <div style="font-size: 0.8em; color: rgb(119, 119, 119);">
                    @Resources.CTS300.lblPleasePayAttention
                </div>
                <div style="font-size: 0.8em; color: rgb(119, 119, 119);">
                    @Resources.CTS300.lblRemarkAttachFileSize
                </div>
            </div>
        <div class="usr-clear-style">&nbsp;</div>
        </div>
    </div>
    <!---------------------------------- End   Attached Document list---------------------------------------------->
    @Html.Hidden("DocAuditResult")
    <br />
    <div id="dlgBox" class="main-popup-dialog">
        <div class="popup-dialog"></div>
    </div>

