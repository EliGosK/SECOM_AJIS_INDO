//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated from a template.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Collections;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Collections.Specialized;
using System.ComponentModel.DataAnnotations;
using SECOM_AJIS.Common.CustomAttribute;
using SECOM_AJIS.DataEntity.Contract.MetaData;

namespace SECOM_AJIS.DataEntity.Contract
{
    [MetadataType(typeof(dtARList_MetaData))]
    public partial class dtARList
    {
        private static string YES = "y";
        private static string NO = "n";
        private static string NONE = "-";

        public string OverNewImportant { get; set; }
        public string Important { get; set; }
        public bool isStatusYellow { get; set; }

        public string ARStatusName { get; set; }
        public string ARTypeName { get; set; }
        public string ApprEmpFirstName { get; set; }
        public string ApprEmpLastName { get; set; }
        public string ReqEmpFirstName { get; set; }
        public string ReqEmpLastName { get; set; }
        public string AudEmpFirstName { get; set; }
        public string AudEmpLastName { get; set; }
        public string DeadLineTimeName { get; set; }

        public string RequestApproveNo
        {
            get
            {
                var util = new SECOM_AJIS.Common.Util.CommonUtil();
                return string.Format("<RequestNo value='{0}'/><ApproveNo value='{1}'/><ContractCode value='{2}'/>"
                    , RequestNo ?? ""
                    , ApproveNo ?? ""
                    , util.ConvertContractCode(ContractCode, SECOM_AJIS.Common.Util.CommonUtil.CONVERT_TYPE.TO_SHORT) ?? ""
                );
            }
        }

        public string RealCustomer {
            get {
                if ((RealCustFullNameEN == null || RealCustFullNameEN == "" )
                    && (RealCustFullNameLC == null || RealCustFullNameLC == ""))
                {
                    return null;
                }

                string en = NONE;
                string lc = NONE;
                if (RealCustFullNameEN != null && RealCustFullNameEN != "") {
                    en = RealCustFullNameEN;
                }

                if (RealCustFullNameLC != null && RealCustFullNameLC != "") {
                    lc = RealCustFullNameLC;
                }

                return "(1) " + en + "<br/>(2) " + lc;
            }
        }

        public string SiteName {
            get {
                if ((SiteNameEN == null || SiteNameEN == "") && (SiteNameLC == null || SiteNameLC == "")) {
                    return null;
                }

                string en = NONE;
                string lc = NONE;
                if (SiteNameEN != null && SiteNameEN != "") {
                    en = SiteNameEN;
                }

                if (SiteNameLC != null && SiteNameLC != "") {
                    lc = SiteNameLC;
                }

                return "(1) " + en + "<br/>(2) " + lc;
            }
        }

        public string DueDateDeadLineDisplay {
            get {
                if (DueDateDeadLine.HasValue) {
                    string date = DueDateDeadLine.Value.ToString("dd-MMM-yyyy");
                    string time = null;
                    if (DueDateTime.HasValue) {
                        //time = DueDateTime.Value.ToString("hh:mm");
                        time = string.Format("{0}:{1}",
                                string.Format("{0:00}", DueDateTime.Value.Hours),
                                string.Format("{0:00}", DueDateTime.Value.Minutes));
                    } else {
                        time = DeadLineTimeName;
                    }

                    return date + "<br/>" + time;
                }

                return "-";
            }
        }

        public string Approver {
            get {
                return ApprEmpFirstName + " " + ApprEmpLastName;
            }
        }

        public string Requester {
            get {
                return ReqEmpFirstName + " " + ReqEmpLastName;
            }
        }

        public string ARStatusNameDisplay {
            get {
                if (isStatusYellow)
                    return YES + ARStatusName;
                else
                    return NO + ARStatusName;
            }
        }

        public string ARTitleName { get; set; }

        public string ARTypeAndARTitleName
        {
            get
            {
                return "(1) " + this.ARTypeName + "<br/>(2) " + this.ARTitleName;
            }
        }

        public string LastactionDateAndRequestDate
        {
            get
            {
                return string.Format("(1) {0}<br/>(2) {1}"
                    , this.UpdateDate.HasValue ? this.UpdateDate.Value.ToString("yyyy-MM-dd") : ""
                    , this.CreateDate.HasValue ? this.CreateDate.Value.ToString("yyyy-MM-dd") : ""
                );
            }
        }

        public string ApproverAuditorAndRequester
        {
            get
            {
                return string.Format("(1) {0}<br/>(2) {1}<br/>(3) {2}"
                    , this.Approver
                    , string.IsNullOrEmpty(this.Auditor) ? NONE : this.Auditor
                    , this.Requester
                );
            }
        }

        public string Auditor
        {
            get
            {
                if (string.IsNullOrEmpty(AudEmpFirstName) && string.IsNullOrEmpty(AudEmpLastName))
                    return string.Empty;
                else
                    return AudEmpFirstName + " " + AudEmpLastName;
            }
        }

        public string RealCustomerSiteName
        {
            get
            {
                if ((RealCustFullNameEN == null || RealCustFullNameEN == "")
                    && (RealCustFullNameLC == null || RealCustFullNameLC == "")
                    && (SiteNameEN == null || SiteNameEN == "") 
                    && (SiteNameLC == null || SiteNameLC == ""))
                {
                    return null;
                }

                string realcust_en = NONE;
                string realcust_lc = NONE;
                if (RealCustFullNameEN != null && RealCustFullNameEN != "")
                {
                    realcust_en = RealCustFullNameEN;
                }

                if (RealCustFullNameLC != null && RealCustFullNameLC != "")
                {
                    realcust_lc = RealCustFullNameLC;
                }

                string sitename_en = NONE;
                string sitename_lc = NONE;
                if (SiteNameEN != null && SiteNameEN != "")
                {
                    sitename_en = SiteNameEN;
                }

                if (SiteNameLC != null && SiteNameLC != "")
                {
                    sitename_lc = SiteNameLC;
                }

                return "(1) " + realcust_en + "<br/>(2) " + realcust_lc + "<br/>(3) " + sitename_en + "<br/>(4) " + sitename_lc;
            }
        }

    }
}

namespace SECOM_AJIS.DataEntity.Contract.MetaData
{
    public class dtARList_MetaData
    {
        [LanguageMapping]
        public string ARStatusName { get; set; }
        [LanguageMapping]
        public string ARTypeName { get; set; }
        [LanguageMapping]
        public string ApprEmpFirstName { get; set; }
        [LanguageMapping]
        public string ApprEmpLastName { get; set; }
        [LanguageMapping]
        public string ReqEmpFirstName { get; set; }
        [LanguageMapping]
        public string ReqEmpLastName { get; set; }
        [LanguageMapping]
        public string AudEmpFirstName { get; set; }
        [LanguageMapping]
        public string AudEmpLastName { get; set; }
        [DeadLineTimeTypeMapping("DeadLineTimeName")]
        public string DeadLineTime { get; set; }
        [LanguageMapping]
        public string ARTitleName { get; set; }
    }
}
