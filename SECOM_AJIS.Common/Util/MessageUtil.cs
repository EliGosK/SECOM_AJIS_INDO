using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Web.Mvc;

using SECOM_AJIS.Common.Models;
using SECOM_AJIS.Common.Util.ConstantValue;
using System.Xml;


namespace SECOM_AJIS.Common.Util
{
    /// <summary>
    /// Message management
    /// </summary>
    public class MessageUtil
    {
        public const string MODULE_COMMON = "Common";
        public const string MODULE_MASTER = "Master";
        public const string MODULE_QUOTATION = "Quotation";
        public const string MODULE_CONTRACT = "Contract";
        public const string MODULE_INSTALLATION = "Installation";
        public const string MODULE_INVENTORY = "Inventory";
        public const string MODULE_BILLING = "Billing";
        public const string MODULE_INCOME = "Income";
        //2017.01.27 Add by Y.Shibahara For Indonesia START
        public const string MODULE_ACCOUNTING = "Accounting";
        //2017.01.27 Add by Y.Shibahara For Indonesia END
        public enum MessageList
        {
            //Common
            MSG0001 = 0,
            MSG0006,
            MSG0007,
            MSG0009,
            MSG0011,
            MSG0012,
            MSG0013,
            MSG0014,
            MSG0015,
            MSG0016,
            MSG0017,
            MSG0018,
            MSG0019,
            MSG0021,
            MSG0022,
            MSG0023,
            MSG0024,
            MSG0025,
            MSG0026,
            MSG0028,
            MSG0029,
            MSG0030,
            MSG0031,
            MSG0032,
            MSG0034,
            MSG0038,
            MSG0040,
            MSG0043,
            MSG0044,
            MSG0045,
            MSG0046,
            MSG0047,
            MSG0049,
            MSG0050,
            MSG0051,
            MSG0052,
            MSG0053,
            MSG0054,
            MSG0055,
            MSG0056,
            MSG0057,
            MSG0058,
            MSG0059,
            MSG0060,
            MSG0061,
            MSG0062,
            MSG0063,
            MSG0064,
            MSG0065,
            MSG0066,
            MSG0067,
            MSG0068,
            MSG0069,
            MSG0070,
            MSG0071,
            MSG0072,
            MSG0073,
            MSG0074,
            MSG0075,
            MSG0076,
            MSG0077,
            MSG0078,
            MSG0079,
            MSG0081,
            MSG0082,
            MSG0083,
            MSG0084,
            MSG0085,
            MSG0086,
            MSG0087,
            MSG0088,
            MSG0089,
            MSG0090,
            MSG0091,
            MSG0092,
            MSG0093,
            MSG0094,
            MSG0095,
            MSG0096,
            MSG0097,
            MSG0098,
            MSG0099,
            MSG0033,
            MSG0080,
            MSG0100,
            MSG0101,
            MSG0102,
            MSG0103,
            MSG0104,
            MSG0105,
            MSG0106,
            MSG0107,
            MSG0108,
            MSG0109,
            MSG0110,
            MSG0111,
            MSG0112,
            MSG0113,
            MSG0114,
            MSG0115,
            MSG0116,
            MSG0117,
            MSG0118,
            MSG0119,
            MSG0120,
            MSG0121,
            MSG0122,
            MSG0123,
            MSG0124,
            MSG0125,
            MSG0126,
            MSG0127,
            MSG0128,
            MSG0129,
            MSG0130,
            MSG0131,
            MSG0132,
            MSG0133,
            MSG0134,
            MSG0135,
            MSG0136,
            MSG0137,
            MSG0138,
            MSG0139,
            MSG0140,
            MSG0141,
            MSG0142,
            MSG0143,
            MSG0144,
            MSG0145,
            MSG0146,
            MSG0147,
            MSG0148,
            MSG0149,
            MSG0150,
            MSG0151,
            MSG0152,
            MSG0153,
            MSG0154,
            MSG0155,
            MSG0156,
            MSG0157,
            MSG0158,
            MSG0159,
            MSG0160,
            MSG0161,
            MSG0162,
            MSG0163,
            MSG0164,
            MSG0165,
            MSG0334,
            MSG0PWL,

            // Master
            MSG1001,
            MSG1002,
            MSG1003,
            MSG1004,
            MSG1005,
            MSG1006,
            MSG1007,
            MSG1008,
            MSG1009,
            MSG1010,
            MSG1011,
            MSG1012,
            MSG1013,
            MSG1014,
            MSG1015,
            MSG1016,
            MSG1017,
            MSG1018,
            MSG1019,
            MSG1020,
            MSG1021,
            MSG1022,
            MSG1023,
            MSG1024,
            MSG1025,
            MSG1026,
            MSG1027,
            MSG1028,
            MSG1029,
            MSG1030,
            MSG1031,
            MSG1032,
            MSG1033,
            MSG1034,
            MSG1035,
            MSG1036,
            MSG1037,
            MSG1038,
            MSG1039,
            MSG1040,
            MSG1041,
            MSG1042,
            MSG1043,
            MSG1044,
            MSG1045,
            MSG1046,
            MSG1047,
            MSG1048,
            MSG1049,
            MSG1050,
            MSG1051,
            MSG1052,
            MSG1055,
            MSG1056,
            MSG1057,
            MSG1058,
            MSG1059,
            MSG1060,
            MSG1061,
            MSG1062,

            // 
            MSG2001,
            MSG2002,
            MSG2003,
            MSG2004,
            MSG2005,
            MSG2006,
            MSG2007,
            MSG2008,
            MSG2009,
            MSG2010,
            MSG2011,
            MSG2012,
            MSG2013,
            MSG2014,
            MSG2015,
            MSG2016,
            MSG2017,
            MSG2018,
            MSG2019,
            MSG2020,
            MSG2021,
            MSG2022,
            MSG2023,
            MSG2024,
            MSG2025,
            MSG2026,
            MSG2027,
            MSG2028,
            MSG2029,
            MSG2030,
            MSG2031,
            MSG2032,
            MSG2033,
            MSG2034,
            MSG2035,
            MSG2036,
            MSG2037,
            MSG2038,
            MSG2039,
            MSG2040,
            MSG2041,
            MSG2042,
            MSG2043,
            MSG2044,
            MSG2045,
            MSG2046,
            MSG2047,
            MSG2048,
            MSG2049,
            MSG2050,
            MSG2051,
            MSG2052,
            MSG2053,
            MSG2054,
            MSG2055,
            MSG2056,
            MSG2057,
            MSG2058,
            MSG2059,
            MSG2060,
            MSG2061,
            MSG2062,
            MSG2063,
            MSG2064,
            MSG2065,
            MSG2066,
            MSG2067,
            MSG2068,
            MSG2069,
            MSG2070,
            MSG2071,
            MSG2072,
            MSG2073,
            MSG2074,
            MSG2075,
            MSG2076,
            MSG2077,
            MSG2078,
            MSG2079,
            MSG2080,
            MSG2081,
            MSG2082,
            MSG2083,
            MSG2084,
            MSG2085,
            MSG2086,
            MSG2087,
            MSG2088,
            MSG2089,
            MSG2090,
            MSG2091,
            MSG2092,
            MSG2093,

            //Contract
            MSG3001,
            MSG3002,
            MSG3003,
            MSG3004,
            MSG3005,
            MSG3006,
            MSG3007,
            MSG3008,
            MSG3009,
            MSG3010,
            MSG3011,
            MSG3012,
            MSG3013,
            MSG3014,
            MSG3015,
            MSG3016,
            MSG3017,
            MSG3018,
            MSG3019,
            MSG3020,
            MSG3021,
            MSG3022,
            MSG3023,
            MSG3024,
            MSG3025,
            MSG3026,
            MSG3027,
            MSG3028,
            MSG3029,
            MSG3030,
            MSG3031,
            MSG3032,
            MSG3033,
            MSG3034,
            MSG3035,
            MSG3036,
            MSG3037,
            MSG3038,
            MSG3039,
            MSG3040,
            MSG3041,
            MSG3042,
            MSG3043,
            MSG3044,
            MSG3045,
            MSG3046,
            MSG3047,
            MSG3048,
            MSG3049,
            MSG3050,
            MSG3051,
            MSG3052,
            MSG3053,
            MSG3054,
            MSG3055,
            MSG3056,
            MSG3057,
            MSG3058,
            MSG3059,
            MSG3060,
            MSG3061,
            MSG3062,
            MSG3063,
            MSG3064,
            MSG3065,
            MSG3066,
            MSG3067,
            MSG3068,
            MSG3069,
            MSG3070,
            MSG3071,
            MSG3072,
            MSG3073,
            MSG3075,
            MSG3074,
            MSG3076,
            MSG3077,
            MSG3078,
            MSG3079,
            MSG3080,
            MSG3081,
            MSG3082,
            MSG3083,
            MSG3084,
            MSG3085,
            MSG3086,
            MSG3087,
            MSG3088,
            MSG3089,
            MSG3090,
            MSG3091,
            MSG3092,
            MSG3093,
            MSG3094,
            MSG3095,
            MSG3096,
            MSG3097,
            MSG3098,
            MSG3099,
            MSG3100,
            MSG3101,
            MSG3102,
            MSG3103,
            MSG3104,
            MSG3105,
            MSG3106,
            MSG3107,
            MSG3108,
            MSG3109,
            MSG3110,
            MSG3111,
            MSG3112,
            MSG3113,
            MSG3115,
            MSG3116,
            MSG3117,
            MSG3118,
            MSG3119,
            MSG3120,
            MSG3121,
            MSG3122,
            MSG3123,
            MSG3124,
            MSG3125,
            MSG3126,
            MSG3127,
            MSG3128,
            MSG3129,
            MSG3130,
            MSG3131,
            MSG3132,
            MSG3133,
            MSG3134,
            MSG3135,
            MSG3136,
            MSG3137,
            MSG3138,
            MSG3139,
            MSG3140,
            MSG3141,
            MSG3142,
            MSG3143,
            MSG3144,
            MSG3145,
            MSG3146,
            MSG3147,
            MSG3148,
            MSG3149,
            MSG3150,
            MSG3151,
            MSG3152,
            MSG3153,
            MSG3154,
            MSG3155,
            MSG3156,
            MSG3157,
            MSG3158,
            MSG3159,
            MSG3160,
            MSG3161,
            MSG3162,
            MSG3163,
            MSG3164,
            MSG3165,
            MSG3166,
            MSG3167,
            MSG3168,
            MSG3169,
            MSG3170,
            MSG3171,
            MSG3172,
            MSG3173,
            MSG3174,
            MSG3175,
            MSG3176,
            MSG3177,
            MSG3178,
            MSG3179,
            MSG3180,
            MSG3181,
            MSG3182,
            MSG3183,
            MSG3184,
            MSG3185,
            MSG3186,
            MSG3187,
            MSG3188,
            MSG3189,
            MSG3190,
            MSG3191,
            MSG3192,
            MSG3193,
            MSG3194,
            MSG3195,
            MSG3196,
            MSG3197,
            MSG3198,
            MSG3199,
            MSG3200,
            MSG3201,
            MSG3202,
            MSG3203,
            MSG3204,
            MSG3205,
            MSG3206,
            MSG3207,
            MSG3208,
            MSG3209,
            MSG3210,
            MSG3211,
            MSG3212,
            MSG3213,
            MSG3214,
            MSG3215,
            MSG3216,
            MSG3217,
            MSG3218,
            MSG3219,
            MSG3220,
            MSG3221,
            MSG3222,
            MSG3224,
            MSG3223,
            MSG3225,
            MSG3226,
            MSG3227,
            MSG3228,
            MSG3229,
            MSG3230,
            MSG3231,
            MSG3232,
            MSG3233,
            MSG3234,
            MSG3235,
            MSG3236,
            MSG3237,
            MSG3238,
            MSG3239,
            MSG3240,
            MSG3241,
            MSG3242,
            MSG3243,
            MSG3244,
            MSG3245,
            MSG3246,
            MSG3247,
            MSG3248,
            MSG3249,
            MSG3250,
            MSG3251,
            MSG3252,
            MSG3253,
            MSG3254,
            MSG3255,
            MSG3256,
            MSG3257,
            MSG3258,
            MSG3259,
            MSG3260,
            MSG3261,
            MSG3262,
            MSG3263,
            MSG3264,
            MSG3265,
            MSG3266,
            MSG3267,
            MSG3268,
            MSG3269,
            MSG3270,
            MSG3271,
            MSG3272,
            MSG3273,
            MSG3274,
            MSG3275,
            MSG3276,
            MSG3277,
            MSG3278,
            MSG3279,
            MSG3280,
            MSG3281,
            MSG3282,
            MSG3283,
            MSG3284,
            MSG3285,
            MSG3286,
            MSG3287,
            MSG3288,
            MSG3289,
            MSG3290,
            MSG3291,
            MSG3292,
            MSG3293,
            MSG3294,
            MSG3295,
            MSG3296,
            MSG3297,
            MSG3298,
            MSG3299,
            MSG3300,
            MSG3301,
            MSG3302,
            MSG3303,
            MSG3304,
            MSG3305,
            MSG3306,
            MSG3307,
            MSG3308,
            MSG3309,
            MSG3310,
            MSG3311,
            MSG3312,
            MSG3313,
            MSG3314,
            MSG3315,
            MSG3316,
            MSG3317,
            MSG3318,
            MSG3319,
            MSG3320,
            MSG3321,
            MSG3322,
            MSG3323,
            MSG3324,
            MSG3325,
            MSG3326,
            MSG3327,
            MSG3328,
            MSG3329,
            MSG3330,
            MSG3331,
            MSG3332,
            MSG3333,
            MSG3334,
            MSG3335,
            MSG3336,
            MSG3337,
            MSG3338,
            MSG3340,
            MSG3341,
            MSG3342,
            MSG3343,
            MSG3344,
            MSG3345,
            MSG3346,
            MSG3347,
            MSG3348,
            MSG3349,
            MSG3350,
            MSG3351,
            MSG3352,
            MSG3353,
            MSG3354,
            MSG3355,
            MSG3356,
            MSG3357,
            MSG3358,
            MSG3359,
            MSG3360,
            MSG3361,
            MSG3362,
            MSG3363,
            MSG3364,
            MSG3365,
            MSG3366,
            MSG3367,
            MSG3368,
            MSG3369,
            MSG3370,
            MSG3371,

            // Inventory 
            MSG4001,
            MSG4002,
            MSG4003,
            MSG4004,
            MSG4005,
            MSG4006,
            MSG4007,
            MSG4008,
            MSG4009,
            MSG4010,
            MSG4011,
            MSG4012,
            MSG4013,
            MSG4014,
            MSG4015,
            MSG4016,
            MSG4017,
            MSG4018,
            MSG4019,
            MSG4020,
            MSG4021,
            MSG4022,
            MSG4023,
            MSG4024,
            MSG4025,
            MSG4026,
            MSG4027,
            MSG4028,
            MSG4029,
            MSG4030,
            MSG4031,
            MSG4032,
            MSG4033,
            MSG4034,
            MSG4035,
            MSG4036,
            MSG4037,
            MSG4038,
            MSG4039,
            MSG4040,
            MSG4041,
            MSG4042,
            MSG4043,
            MSG4044,
            MSG4045,
            MSG4046,
            MSG4047,
            MSG4048,
            MSG4049,
            MSG4050,
            MSG4051,
            MSG4052,
            MSG4053,
            MSG4054,
            MSG4055,
            MSG4056,
            MSG4057,
            MSG4058,
            MSG4059,
            MSG4060,
            MSG4061,
            MSG4062,
            MSG4063,
            MSG4064,
            MSG4065,
            MSG4066,
            MSG4067,
            MSG4068,
            MSG4069,
            MSG4070,
            MSG4071,
            MSG4072,
            MSG4073,
            MSG4074,
            MSG4075,
            MSG4076,
            MSG4077,
            MSG4078,
            MSG4079,
            MSG4080,
            MSG4081,
            MSG4082,
            MSG4083,
            MSG4084,
            MSG4085,
            MSG4086,
            MSG4087,
            MSG4088,
            MSG4089,
            MSG4090,
            MSG4091,
            MSG4092,
            MSG4093,
            MSG4094,
            MSG4095,
            MSG4096,
            MSG4097,
            MSG4098,
            MSG4099,
            MSG4100,
            MSG4101,
            MSG4104,
            MSG4105,
            MSG4106,
            MSG4107,
            MSG4108,
            MSG4109,
            MSG4112,
            MSG4113,
            MSG4114,
            MSG4115,
            MSG4116,
            MSG4117,
            MSG4118,
            MSG4119,
            MSG4120,
            MSG4121,
            MSG4122,
            MSG4102,
            MSG4103,
            MSG4123,
            MSG4124,
            MSG4125,
            MSG4126,
            MSG4127,
            MSG4128,
            MSG4129,
            MSG4130,
            MSG4131,
            MSG4132,
            MSG4133,
            MSG4134,
            MSG4135,
            MSG4136,
            MSG4137,
            MSG4138,
            MSG4139,
            MSG4140,
            MSG4141,
            MSG4142,
            MSG4143,
            MSG4144,
            MSG4145,
            MSG4146,
            MSG4147,
            MSG4148,
            MSG4149,

            MSG5001,
            MSG5002,
            MSG5003,
            MSG5004,
            MSG5005,
            MSG5006,
            MSG5007,
            MSG5008,
            MSG5009,
            MSG5010,
            MSG5011,
            MSG5012,
            MSG5013,
            MSG5014,
            MSG5015,
            MSG5016,
            MSG5017,
            MSG5018,
            MSG5019,
            MSG5020,
            MSG5021,
            MSG5022,
            MSG5023,
            MSG5024,
            MSG5025,
            MSG5026,
            MSG5027,
            MSG5028,
            MSG5029,
            MSG5030,
            MSG5031,
            MSG5032,
            MSG5033,
            MSG5034,
            MSG5035,
            MSG5036,
            MSG5037,
            MSG5038,
            MSG5039,
            MSG5040,
            MSG5041,
            MSG5042,
            MSG5043,
            MSG5044,
            MSG5045,
            MSG5046,
            MSG5047,
            MSG5048,
            MSG5049,
            MSG5050,
            MSG5051,
            MSG5052,
            MSG5053,
            MSG5054,
            MSG5055,
            MSG5056,
            MSG5057,
            MSG5058,
            MSG5059,
            MSG5060,
            MSG5061,
            MSG5062,
            MSG5063,
            MSG5064,
            MSG5065,
            MSG5066,
            MSG5067,
            MSG5068,
            MSG5069,
            MSG5070,
            MSG5071,
            MSG5072,
            MSG5073,
            MSG5074,
            MSG5075,
            MSG5076,
            MSG5077,
            MSG5078,
            MSG5079,
            MSG5080,
            MSG5081,
            MSG5082,
            MSG5083,
            MSG5084,
            MSG5085,
            MSG5086,
            MSG5087,
            MSG5088,
            MSG5089,
            MSG5090,
            MSG5091,
            MSG5092,
            MSG5093,
            MSG5094,
            MSG5095,
            MSG5096,
            MSG5097,
            MSG5098,
            MSG5099,
            MSG5100,
            MSG5101,
            MSG5102,
            MSG5103,
            MSG5104,
            MSG5105,
            MSG5106,
            MSG5107,
            MSG5108,
            MSG5109,
            MSG5110,
            MSG5111,
            MSG5112,
            MSG5113,
            MSG5114,
            MSG5115,
            MSG5116,
            MSG5117,
            MSG5118,
            MSG5119,
            MSG5120,
            MSG5121,
            MSG5122,
            MSG5123,
            MSG5124,
            MSG5125,
            MSG5126,

            //Billing
            MSG6001,
            MSG6002,
            MSG6003,
            MSG6004,
            MSG6005,
            MSG6006,
            MSG6007,
            MSG6008,
            MSG6009,
            MSG6010,
            MSG6011,
            MSG6012,
            MSG6013,
            MSG6014,
            MSG6015,
            MSG6016,
            MSG6017,
            MSG6018,
            MSG6019,
            MSG6020,
            MSG6021,
            MSG6022,
            MSG6023,
            MSG6024,
            MSG6025,
            MSG6026,
            MSG6027,
            MSG6028,
            MSG6029,
            MSG6030,
            MSG6031,
            MSG6032,
            MSG6033,
            MSG6034,
            MSG6035,
            MSG6036,
            MSG6037,
            MSG6038,
            MSG6039,
            MSG6040,
            MSG6041,
            MSG6042,
            MSG6043,
            MSG6044,
            MSG6045,
            MSG6046,
            MSG6047,
            MSG6048,
            MSG6049,
            MSG6050,
            MSG6051,
            MSG6052,
            MSG6053,
            MSG6054,
            MSG6055,
            MSG6056,
            MSG6057,
            MSG6058,
            MSG6059,
            MSG6060,
            MSG6061,
            MSG6062,
            MSG6063,
            MSG6064,
            MSG6065,
            MSG6066,
            MSG6067,
            MSG6068,
            MSG6069,
            MSG6070,
            MSG6071,
            MSG6072,
            MSG6073,
            MSG6074,
            MSG6075,
            MSG6076,
            MSG6077,
            MSG6078,
            MSG6079,
            MSG6080,
            MSG6081,
            MSG6082,
            MSG6083,
            MSG6084,
            MSG6085,
            MSG6086,
            MSG6087,
            MSG6088,
            MSG6089,
            MSG6090,
            MSG6091,
            MSG6092,
            MSG6093,
            MSG6094,

            // Income
            MSG7001,
            MSG7002,
            MSG7003,
            MSG7004,
            MSG7005,
            MSG7006,
            MSG7007,
            MSG7008,
            MSG7009,
            MSG7010,
            MSG7011,
            MSG7012,
            MSG7013,
            MSG7014,
            MSG7015,
            MSG7016,
            MSG7017,
            MSG7018,
            MSG7019,
            MSG7020,
            MSG7021,
            MSG7022,
            MSG7023,
            MSG7024,
            MSG7025,
            MSG7026,
            MSG7027,
            MSG7028,
            MSG7029,
            MSG7030,
            MSG7031,
            MSG7032,
            MSG7033,
            MSG7034,
            MSG7035,
            MSG7036,
            MSG7037,
            MSG7038,
            MSG7039,
            MSG7040,
            MSG7041,
            MSG7042,
            MSG7043,
            MSG7044,
            MSG7045,
            MSG7046,
            MSG7047,
            MSG7048,
            MSG7049,
            MSG7050,
            MSG7051,
            MSG7052,
            MSG7053,
            MSG7054,
            MSG7055,
            MSG7056,
            MSG7057,
            MSG7058,
            MSG7059,
            MSG7060,
            MSG7061,
            MSG7062,
            MSG7063,
            MSG7064,
            MSG7065,
            MSG7066,
            MSG7067,
            MSG7068,
            MSG7069,
            MSG7070,
            MSG7071,
            MSG7072,
            MSG7073,
            MSG7074,
            MSG7075,
            MSG7076,
            MSG7077,
            MSG7078,
            MSG7079,
            MSG7080,
            MSG7081,
            MSG7082,
            MSG7083,
            MSG7084,
            MSG7085,
            MSG7086,
            MSG7087,
            MSG7088,
            MSG7089,
            MSG7090,
            MSG7091,
            MSG7092,
            MSG7093,
            MSG7094,
            MSG7095,
            MSG7096,
            MSG7097,
            MSG7098,
            MSG7099,
            MSG7100,
            MSG7101,
            MSG7102,
            MSG7103,
            MSG7104,
            MSG7105,
            MSG7106,
            MSG7107,
            MSG7108,
            MSG7109,
            MSG7110,
            MSG7111,
            MSG7112,
            MSG7113,
            MSG7114,
            MSG7115,
            MSG7116,
            MSG7117,
            MSG7118,
            MSG7119,
            MSG7120,
            MSG7121,
            MSG7122,
            MSG7123,
            MSG7124,
            MSG7125,
            MSG7126,
            MSG7127,
            MSG7128,
            MSG7129,
            MSG7130,
            MSG7131,

            // Accounting
            MSG8001,
            MSG8002,
            MSG8003,
            MSG8004,
            MSG8005
        }

        /// <summary>
        /// Get message from resource
        /// </summary>
        /// <param name="module"></param>
        /// <param name="code"></param>
        /// <param name="param"></param>
        /// <returns></returns>
        public static MessageModel GetMessage(string module, MessageUtil.MessageList code, params string[] param)
        {
            string msgCode = code.ToString();
            return GetMessage(module, msgCode, param);
        }
        /// <summary>
        /// Get message from resource
        /// </summary>
        /// <param name="module"></param>
        /// <param name="code"></param>
        /// <param name="param"></param>
        /// <returns></returns>
        public static MessageModel GetMessage(string module, string code, params string[] param)
        {
            MessageModel msg = new MessageModel();
            msg.MessageType = MessageModel.MESSAGE_TYPE.INFORMATION;
            msg.Code = code;

            try
            {
                string assembly = string.Format("{0}.{1}.dll", CommonValue.MESSAGE_ASSEMBLY, module);

                CommonUtil util = new CommonUtil();
                System.Resources.ResourceSet rs = util.GetResource(assembly, CommonValue.MESSAGE_NAMESPACE);

                msg.Message = string.Format(rs.GetString(code), param == null ? new string[] { "" } : param);
            }
            catch
            {
                msg.Message = CommonValue.MESSAGE_NOTFOUND;
            }

            return msg;
        }
        /// <summary>
        /// Get message from resource
        /// </summary>
        /// <param name="controller"></param>
        /// <param name="screen"></param>
        /// <param name="module"></param>
        /// <param name="code"></param>
        /// <param name="param"></param>
        /// <returns></returns>
        public static MessageModel GetMessageForScreen(string controller, string screen, string module, MessageUtil.MessageList code, params string[] param)
        {
            string msgCode = code.ToString();
            return GetMessageForScreen(controller, screen, module, msgCode, param);
        }
        /// <summary>
        /// Get message from resource
        /// </summary>
        /// <param name="controller"></param>
        /// <param name="screen"></param>
        /// <param name="module"></param>
        /// <param name="code"></param>
        /// <param name="param"></param>
        /// <returns></returns>
        public static MessageModel GetMessageForScreen(string controller, string screen, string module, string code, params string[] param)
        {
            MessageModel msg = new MessageModel();
            msg.MessageType = MessageModel.MESSAGE_TYPE.INFORMATION;
            msg.Code = code;

            try
            {
                string assembly = string.Format("{0}.{1}.dll", CommonValue.MESSAGE_ASSEMBLY, module);

                CommonUtil util = new CommonUtil();
                System.Resources.ResourceSet rs = util.GetResource(assembly, CommonValue.MESSAGE_NAMESPACE);

                MessageUtil m = new MessageUtil();
                string[] nparam = m.ConvertParameters(controller, screen, param);
                msg.Message = string.Format(rs.GetString(code), nparam);
            }
            catch
            {
                msg.Message = CommonValue.MESSAGE_NOTFOUND;
            }

            return msg;
        }
        /// <summary>
        /// Mapping text from resource
        /// </summary>
        /// <param name="controller"></param>
        /// <param name="screen"></param>
        /// <param name="param"></param>
        /// <returns></returns>
        private string[] ConvertParameters(string controller, string screen, params string[] param)
        {
            List<string> nparam = new List<string>();

            if (param != null)
            {
                string lang = CommonUtil.GetCurrentLanguage();
                if (lang == ConstantValue.CommonValue.DEFAULT_LANGUAGE_EN)
                    lang = string.Empty;
                else
                    lang = "." + lang;

                string resourcePath = string.Format("{0}{1}\\{2}\\{3}{4}.resx",
                                                                CommonUtil.WebPath,
                                                                ConstantValue.CommonValue.APP_GLOBAL_RESOURCE_FOLDER,
                                                                controller,
                                                                screen,
                                                                lang);
                XmlDocument rDoc = new XmlDocument();
                rDoc.Load(resourcePath);

                foreach (string p in param)
                {
                    bool isMappingResource = false;
                    List<string> slst = new List<string>();
                    string[] lp = p.Split(",".ToCharArray());
                    foreach (string l in lp)
                    {
                        XmlNode rNode = rDoc.SelectSingleNode(string.Format("root/data[@name=\"{0}\"]/value", l.Trim()));
                        if (rNode != null)
                        {
                            slst.Add(rNode.InnerText);
                            isMappingResource = true;
                        }
                        else
                            slst.Add(l);
                    }

                    string txt = CommonUtil.TextList(slst.ToArray());
                    if (isMappingResource == false && lp.Length > 1)
                    {
                        //Check is Number
                        decimal dec = 0;
                        if (decimal.TryParse(p, out dec))
                            txt = p;
                    }

                    nparam.Add(txt);
                }
            }

            return nparam.ToArray();
        }
    }
    /// <summary>
    /// DO for add parameter to message
    /// </summary>
    public class MessageParameter
    {
        private class Parameter
        {
            public MessageUtil.MessageList Code { get; set; }
            public string[] Parameters { get; set; }

            public Parameter(MessageUtil.MessageList code, params string[] param)
            {
                this.Code = code;
                this.Parameters = param;
            }
        }

        private List<Parameter> ParameterList { get; set; }
        /// <summary>
        /// Add parameter
        /// </summary>
        /// <param name="code"></param>
        /// <param name="param"></param>
        public void AddParameter(MessageUtil.MessageList code, params string[] param)
        {
            if (this.ParameterList == null)
                this.ParameterList = new List<Parameter>();
            this.ParameterList.Add(new Parameter(code, param));
        }
        /// <summary>
        /// Get parameter from selected code
        /// </summary>
        /// <param name="code"></param>
        /// <returns></returns>
        public string[] GetParameter(string code)
        {
            string[] param = null;
            if (this.ParameterList != null)
            {
                foreach (Parameter p in this.ParameterList)
                {
                    if (p.Code.ToString() == code)
                    {
                        param = p.Parameters;
                        break;
                    }
                }
            }

            return param;
        }
    }
}
